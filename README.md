# AI_Task_Manager

この作品は ChatGPT API を利用したタスク管理アプリです。  
使用者のその日の体力や状態を把握し、登録されたタスクの中から最適なタスクを提案してくれます。

仕組みはシンプルです。

- タスク登録時に「重さ」「期限」「所属プロジェクト」「タグ」などを付与
- 日誌（state.json）からその日の状態を読み取る
- ルールベースのスコア計算を行う
- 最後にGPTが優先順位を再調整する

これにより「今日やるべきこと」を自然な順番で提示します。

---

## 動機

当時、ChatGPTにはまっていた際、  
「AIから話しかけてきてほしい」と思ったことがきっかけでした。

しかし、AIが能動的に話すには「何を話すのか？」という問題があります。  
そこで思いついたのがタスクマネージャーでした。

また、タスクを抱えすぎて体調を崩した経験から、

> オーバーワークを防ぎつつ、背中を押してくれる存在がほしい

と考えるようになりました。

この二つのアイディアを融合して生まれたのが、このアプリです。

---

## AIを使用した開発について

今回、実用のため開発を急いでいたこと、  
さらに Python と Kotlin という未経験言語を同時に扱う必要があったことから、  
AIを活用した開発を行いました。

ただし、

> AIにすべてを書かせるのではなく、理解しながら使う

ことを意識しました。

基本文法は事前にGPTと勉強し、  
レビュー可能な範囲でコードを書き進めました。

Pythonが初心者に優しすぎて驚きました。

---

## 苦労した点

### 1. state構造の揺れと型崩れ問題

日誌(JSON)から生成される `state` の構造が一定ではなく、  
`dict` を想定して書いたコードが `list` を受け取って落ちる問題が発生しました。

代表的なエラーがこれです。

AttributeError: 'list' object has no attribute 'get'


原因は、

- `focus_plan` が辞書ではなく配列になっていた
- 外部JSONを前提構造で扱っていた

ことでした。

この問題から学んだこと：

- 外部入力は必ず正規化する
- `.get()` を使う前に型を保証する
- 想定構造を信じすぎない

現在は、state_effect.py 内で  
`_as_dict / _as_list` による正規化パッチを導入し、  
構造が崩れても落ちない設計にしています。

---

### 2. AIレスポンスの不安定さ

GPT APIは常に理想的なJSONを返すとは限りません。

- ordered_tasks が空配列になる
- JSON形式が崩れる
- タスクが少ないと推薦が返らない

といった問題がありました。

そのため、

- レスポンス内容を必ずログ出力
- JSON解析失敗時はフォールバック
- 千紗（AI）が失敗してもアプリは止まらない設計

に変更しました。

AIは補助レイヤーであり、  
コアロジックは常に自前で動くように設計しています。

---

### 3. 優先度スコア設計

単純な並び替えではなく、以下の多層構造を設計しました。

1. タグごとの重み付け（weight_for_priority）
2. priority_hint補正
3. 期限からの残日数計算
4. stateによる微調整（体調・制約・focus_plan）
5. 最後にGPTで再整列

この構造により、

- AIが失敗してもスコア順で動く
- どこで優先度が変化したか追跡できる
- 説明可能な設計になる

ことを実現しました。

---

### 4. Web版とAndroid版の同期

Web（Flask）とAndroid（Jetpack Compose）を並行開発したため、

- JSON形式の差異
- キャッシュ保存のタイミング
- 直接タスク追加による整合性崩壊

などの問題が発生しました。

その結果、運用ルールも設計の一部として定義しました。

> タスクは直接追加しない  
> 必ず「千歳（秘書）」経由で登録する

技術だけでなく、  
運用設計もアプリ設計の一部であると学びました。

---

## このプロジェクトで得たもの

- FlaskによるREST API設計
- JSON正規化パターン
- GPT Responses API活用
- フォールバック設計
- 状態駆動型スコアリング設計
- Jetpack Compose UI構築
- 複数環境（PC / Android）の同期設計
- エラーから設計を見直す思考

---

## このアプリの本質

これは単なるタスク管理アプリではなく、

> 「今日の状態に応じて意思決定を補助するエンジン」

です。

AIを使うこと自体が目的ではなく、  
AIを安全に組み込み、壊れても動く構造を作ることを重視しました。
