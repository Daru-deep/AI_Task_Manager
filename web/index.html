<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>千紗 - 今日のおすすめ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/style.css">
  
  <!-- JSファイルを順番に読み込む（この順番が重要！） -->
  <script src="/web/chisa.js" defer></script>
  <script src="/web/tasks.js" defer></script>
  <script src="/web/state.js" defer></script>
  <script src="/web/import.js" defer></script>
  <script src="/web/projects.js" defer></script>
  <script src="/web/main.js" defer></script>
</head>

<body>
  <div class="vg-root">
    <!-- 上部バー（タイトル） -->
    <header class="vg-topbar">
      <div class="vg-topbar-left">AI Task Manager - 千紗</div>
      <div class="vg-topbar-right">
        <span id="today-date"></span>
      </div>
    </header>

    <!-- メイン領域：背景＋立ち絵＋タスクパネル -->
    <main class="vg-main">
      <!-- 背景 -->
      <div class="vg-bg"></div>

      <!-- 千紗の立ち絵エリア -->
      <div class="vg-chara-area">
        <!-- 画像は後で差し替え：とりあえずプレースホルダー -->
        <!-- <img src="/web/chisa.png" alt="千紗" class="vg-chara-img"> -->
        <div class="vg-chara-placeholder">千紗</div>
      </div>

      <!-- 右側：タスクパネル（ゲームのメニューウィンドウっぽく） -->
      <section class="vg-panel">
        <!-- タブ風ナビ（ボタンIDはJSで使いやすいように） -->
        <div class="vg-panel-tabs">
          <button id="nav-today" class="vg-tab vg-tab-active">今日のおすすめ</button>
          <button id="nav-state" class="vg-tab">今日のステータス</button>
          <button id="nav-all" class="vg-tab">全タスク</button>
          <button id="nav-projects" class="vg-tab">プロジェクト</button>
          <button id="nav-import" class="vg-tab">日誌インポート</button>
        </div>

        <!-- ビュー領域 -->
        <div class="vg-panel-inner">
          <!-- 今日のおすすめ -->
          <section id="view-today" class="vg-view vg-view-active">
            <div class="vg-view-header">
              <h1>今日のおすすめタスク</h1>
              <button id="btn-refresh-today" class="vg-primary-btn">
                再計算 / 更新
              </button>
            </div>

            <div class="vg-table-wrapper">
              <table class="task-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>内容</th>
                    <th>プロジェクト</th>
                    <th>締切</th>
                    <th>スコア</th>
                    <th>理由</th>
                    <th>状態</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody id="task-body">
                  <!-- main.js がここに行を追加する -->
                </tbody>
              </table>
            </div>
          </section>

          <section id="view-state" class="vg-view">
  <div class="vg-head">
    <h2>今日のステータス</h2>
    <button id="btn-refresh-state" class="vg-btn">更新</button>
  </div>

  <div class="vg-grid">
    <div class="vg-card">
      <div class="vg-card-title">体調</div>
      <div class="vg-big" id="st-physical">-</div>
      <div class="vg-sub" id="st-physical-note"></div>
    </div>

    <div class="vg-card">
      <div class="vg-card-title">メンタル</div>
      <div class="vg-big" id="st-mental">-</div>
      <div class="vg-sub" id="st-mental-note"></div>
    </div>

    <div class="vg-card">
      <div class="vg-card-title">集中</div>
      <div class="vg-big" id="st-focus">-</div>
      <div class="vg-sub" id="st-focus-note"></div>
    </div>

    <div class="vg-card">
      <div class="vg-card-title">今日の制約</div>
      <ul class="vg-list" id="st-constraints"></ul>
    </div>

    <div class="vg-card">
      <div class="vg-card-title">今日やりたいこと</div>
      <ul class="vg-list" id="st-goals"></ul>
    </div>

    <div class="vg-card">
      <div class="vg-card-title">最終更新</div>
      <div class="vg-sub" id="st-updated-at">-</div>
    </div>
  </div>

  <!-- デバッグ用（普段は非表示でOK） -->
  <details class="vg-debug">
    <summary>raw state.json</summary>
    <pre id="state-raw"></pre>
  </details>
</section>



          <!-- 全タスク（枠だけ） -->
          <section id="view-all" class="vg-view">
            <div class="vg-view-header">
              <h1>全タスク</h1>
              <p class="vg-view-note">※ 中身はあとで。今は見た目の枠だけ。</p>
            </div>
          </section>

          <!-- プロジェクトビュー（枠だけ） -->
          <section id="view-projects" class="vg-view">
            <div class="vg-view-header">
              <h1>プロジェクト進捗</h1>
              <button id="btn-refresh-projects" class="vg-btn" onclick="loadProjects()">更新</button>
            </div>
            <div id="project-list"></div>
          </section>

          <!-- 日誌インポート -->
          <section id="view-import" class="vg-view">
  <div class="vg-view-header">
    <h1>日誌インポート</h1>
  </div>

  <div class="vg-import-panel">
    <p>① GPT から出てきた <code>state_YYYY-MM-DD.json</code> の中身をそのままコピペして使えます。</p>

    <!-- ★ ここがペースト用 -->
    <textarea
      id="state-text"
      rows="12"
      placeholder="ここに JSON テキストをそのまま貼り付けてね"
      style="width: 100%; font-family: monospace;"
    ></textarea>

    <button id="btn-import-text" class="vg-primary-btn" style="margin-top: 6px;">
      貼り付けたJSONを取り込む
    </button>

    <hr style="margin: 12px 0; opacity: .3;">

    <p>② これまで通り、ファイルからインポートもできます。</p>
    <input type="file" id="state-file" accept=".json,.txt,application/json,text/plain">
    <button id="btn-import" class="vg-primary-btn">ファイルからインポート</button>

    <div id="import-result" class="vg-import-result"></div>
  </div>
</section>
        </div>
      </section>
    </main>

    <!-- 画面下：ギャルゲー風メッセージウィンドウ -->
    <div class="vg-dialog">
      <div class="vg-nameplate">千紗</div>
      <div id="chisa-bubble" class="vg-dialog-text">
        おかえり、小鳥遊。今日もよろしくね。
      </div>
    </div>


    <!-- 一番下：ステータスバー -->
    <footer class="vg-status">
      <span id="status-text">Ready</span>
      <span id="sync-info"></span>
    </footer>
  </div>
</body>


</html>
